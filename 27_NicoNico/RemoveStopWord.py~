#!/usr/bin/env python
# -*- coding: utf-8 -*-

import cPickle
import re

# 形態素解析した結果から、いらない単語を除去する

MAX_PICKLE_FILES = 1
# MAX_SHELVE_FILES = 6
FILES_PER_SHELVE = 50

video_count = 0
dic_file_name = "../../ResearchData/All_Tags"
after_mecab_file = "../../ResearchData/After_Mecab/after_mecab"
after_remove_file = "../../ResearchData/After_Remove/after_remove_stop_word"
pattern = re.compile(u'')

for num in range(0, MAX_PICKLE_FILES):
	# pickle file open
	with open(after_mecab_file + str(num) + '.pkl', 'wb') as f:
		print "open pickle file for load: after_mecab_file" + str(num)
		after_mecabs = cPickle.load(f)
		after_mecabs_decoded = [[word.decode('utf-8') for word in after_mecab] for after_mecab in after_mecabs]
		documents_after_remove = []
		append = documents_after_remove.append
		# 各文書からいらない単語を除去する
		for document in after_mecabs_decoded:
			# document_after_remove = []
			# append_to_document = document_after_remove.append
			# for w in document:
			# 	if not w.find('___'):
			# 		append_to_document(w)
			# 	elif pattern.match(word):
			# 		append_to_document(w)
			doc_after_remove = [w if not w.find('___') else (w if pattern.match(w)) for x in document]
			append(doc_after_remove)
			video_count += 1
			if video_count % 2000 == 0 :
				print "end videos: " + str(video_count)
		with open(after_remove_file + str(num) + 'pkl', 'rb') as f_save:
			print "open pickle file for save: after_remove_file" + str(num)
			cPickle.dump(documents_after_remove, f_save, cPickle.HIGHEST_PROTOCOL)
			print "end save"
			print "end videos: " str(video_count)